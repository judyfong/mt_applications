javascript: var term=document.getSelection(); function detect_lang() { var xhr = new XMLHttpRequest();     xhr.open("GET", "https://nlp.talgreinir.is/langid/detect?q="+term); xhr.send(); xhr.onreadystatechange = function() { if (xhr.readyState == 4 && xhr.status == 200) { var response = JSON.parse(xhr.responseText); detected_lang=response.responseData.language; if (typeof detected_lang !== 'undefined') { if (detected_lang == 'is') { target_lang = 'en'; } else { target_lang = 'is';} var moses = new XMLHttpRequest(); let postdata = {"contents":[term.toString()], "sourceLanguageCode":detected_lang,"targetLanguageCode":    target_lang, "model":"transformer"}; moses.open("POST", "https://velthyding.mideind.is/nn/translate.api"); console.log("hello moses" + term); moses.setRequestHeader('Content-Type', 'application/json'); moses.send(JSON.stringify(postdata)); moses.onreadystatechange = function() { if (moses.readyState == 4 && moses.status == 200) { var translation = JSON.parse(moses.responseText); alert(translation.translations[0].translatedText) } } } }} } detect_lang();
